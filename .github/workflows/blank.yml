name: CI

on: [push]

jobs:
  build:
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [ubuntu-16.04, ubuntu-18.04]

    steps:
    - name: Git clone
      uses: actions/checkout@v1
      with:
        submodules: recursive

    - name: Install dotfiles
      run: bash -c 'bin/dfm install && source ~/.bashrc'
      env:
        SHELL: bash


    - name: Install vim plugins
      run: vim -c 'redir > ~/vim_err.log' -c 'silent! PluginUpdate' -c 'redir END' -c 'qa!'

    - name: Print Output
      run: cat ~/vim_err.log

    - name: Check Output 1
      run: bash -c '! grep -P "^E\d*:" ~/vim_err.log'

    - name: Check Output 2
      run: bash -c '! grep -iP "^Error" ~/vim_err.log'
